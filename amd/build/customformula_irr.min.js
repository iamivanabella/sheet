define([],function(){class e extends HyperFormula.FunctionPlugin{static implementedFunctions={IRR:{method:"irr",parameters:[{argumentType:HyperFormula.FunctionArgumentType.RANGE},{argumentType:HyperFormula.FunctionArgumentType.NUMBER,optionalArg:!0}]}};irr(e,t){try{let r=this.evaluateAst(e.args[0],t),n=e.args[1]?this.evaluateAst(e.args[1],t):.1,i=r.data.flat();if(0===i.length)throw Error("Invalid cash flow data provided to IRR function.");let a=i.some(e=>e>0),u=i.some(e=>e<0);if(!a||!u)return HyperFormula.ErrorType.NUM;return this.calculateIRR(i,n)}catch(l){return HyperFormula.ErrorType.NUM}}calculateIRR(e,t){let r=t;for(let n=0;n<1e3;n++){let i=e.reduce((e,t,n)=>e+t/Math.pow(1+r,n),0),a=e.reduce((e,t,n)=>e-n*t/Math.pow(1+r,n+1),0);if(0===a){r+=.01;continue}let u=r-i/a;if(1e-7>Math.abs(u-r))return u.toFixed(2);r=u}return r.toFixed(2)}}return HyperFormula.registerFunctionPlugin(e,{enGB:{IRR:"IRR"}}),HyperFormula.buildEmpty({licenseKey:"gpl-v3"})});